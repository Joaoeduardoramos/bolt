{% macro menu(items, depth, currentUrl) %}
  {% import _self as macros %}
  <ul class="sub-nav__list sub-nav__list--depth-{{ depth }}">
    {% for item in items %}
      {% set isActive = currentUrl == item.url %}
      <li class="sub-nav__item">
        <a href="/{{ item.url }}" class="sub-nav__link{% if isActive %} sub-nav__link--active{% endif %}">
          {{ item.meta.title }}
        </a>
        {% if item.children %}
          {% set depth = depth + 1 %}
          {{ macros.menu(item.children, depth, currentUrl) }}
        {% endif %}
      </li>
    {% endfor %}
  </ul>
{% endmacro %}

{% import _self as macros %}
{% set currentUrl = page.url %}

<nav class="sub-nav">
  {{ macros.menu(site.nestedPages, 1, currentUrl) }}
</nav>

{#<ul class="sub-nav">#}
  {#{% for page in site.pages if page.dirStructure[0] starts with 'docs' %}#}
    {#<li><a href="/{{ page.url }}">{{ page.meta.title }}</a></li>#}
  {#{% endfor %}#}
{#</ul>#}
