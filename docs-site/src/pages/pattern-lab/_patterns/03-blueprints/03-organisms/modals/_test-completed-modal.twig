{% set modalContent %}
  {% import "@bolt-blueprints/macros.twig" as macros %}

  {% include "@bolt-components-card-replacement/card-replacement.twig" with {
    theme: "dark",
    rounded: true,
    overlay: "disabled",
    background: {
      contentItems: [
        {
          pattern: "image",
          src: "/images/planet-modal.svg",
          lazyload: false,
        }
      ]
    },
    body: {
      attributes: {
        class: [
          "u-bolt-margin-top-auto",
        ]
      },
      content: [
        macros.include("@bolt-components-ratio/ratio.twig", {
          ratio: "150/175",
          children: macros.include("@bolt-components-placeholder/placeholder.twig", {
            text: "FPO",
          }),
          attributes: {
            style: "max-width: 150px",
            class: [
              "u-bolt-margin-top-medium",
              "u-bolt-margin-left-auto",
              "u-bolt-margin-right-auto",
              "u-bolt-margin-bottom-medium"
            ]
          }
        }),
        macros.include("@bolt-components-headline/headline.twig", {
          size: "xxxlarge",
          autoshrink: false,
          text: "Congratulations #{userFirstName}!",
          align: "center",
          attributes: {
            class: [
              "u-bolt-margin-top-small",
              "u-bolt-margin-left-auto",
              "u-bolt-margin-right-auto",
              "c-bolt-headline--xxxlarge-min"
            ]
          }
        }),
        macros.include("@bolt-components-headline/subheadline.twig", {
          text: "Youâ€™ve completed the #{missionName} and earned a new badge!",
          align: "center",
          size: "xlarge",
          weight: "semibold",
          attributes: {
            class: [
              "u-bolt-margin-left-auto",
              "u-bolt-margin-right-auto",
              "u-bolt-line-length-medium",
              "u-bolt-margin-bottom-large",
            ]
          }
        }),
        macros.include("@bolt-components-headline/text.twig", {
          text: "<strong>NOTE:</strong> Please allow 24-48 hours for the badge to appear on your Achievements page.",
          size: "xsmall",
          align: "center",
          attributes: {
            class: [
              "u-bolt-margin-top-small",
              "u-bolt-margin-bottom-small",
              "u-bolt-margin-left-auto",
              "u-bolt-margin-right-auto",
            ]
          }
        }),
        macros.include("@bolt-components-toolbar/toolbar.twig", {
          content_before: "Return to mission",
          gradientName: "purple-solid",
          attributes: {
            class: [
              "u-bolt-negative-margin-left-medium",
              "u-bolt-negative-margin-right-medium",

              "u-bolt-text-align-center"
            ]
          }
        }),
      ] | join('')
    },
  } only %}


{% endset %}

{% include "@bolt-components-modal/modal.twig" with {
  content: modalContent,
  spacing: "none",
  theme: "none",
  width: "optimal",
  scroll: "overall",
  attributes: {
    class: [
      "js-modal-advanced-auto-open",
    ],
    id: "js-modal-advanced-auto-open"
  },
} only %}

<script>
  // Demo code to open the Modal as soon as the page loads

  // Reference to the modal
  var autoOpenModal = document.querySelector('#js-modal-advanced-auto-open');

  // Calls modal 'show' method after a delay
  var setAutoOpenModal = function(el) {
    setTimeout(function(){
      // adjust which window is being checked against if inside an iframe
      // makes sure that this modal doesn't fire on the main viewall section
      var windowToSearch = window.self !== window.top ? window.top.location : window.location;
      if (windowToSearch.search.includes('viewall-pages') === false && windowToSearch.search.includes('viewall-blueprints') === false){
        el.show();
      }
    }, 100)
  }

  // Callback on modal 'ready'
  var onModalReady = function(e) {
    setAutoOpenModal(autoOpenModal);
    // IMPORTANT: remove this event listener unless you want it called each time the modal component renders
    e.target.removeEventListener('modal:ready', onModalReady);
  }

  // Add 'ready' callback
  autoOpenModal.addEventListener('modal:ready', onModalReady);
</script>