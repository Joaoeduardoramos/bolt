/* ------------------------------------ *\
   THEMES
\* ------------------------------------ */

@import '@bolt/core-v3.x';

@function bolt-list-contains($list, $var) {
  $_out: false;

  @each $item in $list {
    @if $item == $var or str-index($item, $var) != null {
      $_out: true;
    }
  }

  @return $_out;
}


@mixin bolt-theme-value($name, $value) {
  @if type-of($value) == color and type-of($value) != string {
    $red: round(red($value));
    $green: round(green($value));
    $blue: round(blue($value));
    --bolt-theme-#{$name}: #{$red, $green, $blue};
  }

  @else {
    --bolt-theme-#{$name}: #{$value};
  }
}

$uniquePerTheme: 'background', 'text';

@each $themeName, $themeOptions in $bolt-themes {
  $themeTypeSelector: '';
  $themeSpecificSelector: '.t-bolt-#{$themeName}';
  
  @if ($themeName == 'xlight') {
    $themeSpecificSelector: ':root, .t-bolt-xlight';
  }
  
  @if ($themeName == 'xdark' or $themeName == 'dark') {
    $themeTypeSelector: '.t-bolt-dark, .t-bolt-xdark';
  } @else {
    $themeTypeSelector: ':root, .t-bolt-xlight, .t-bolt-light';
  }

  @if ($themeName == 'xlight' or $themeName == 'xdark') {
    #{unquote($themeTypeSelector)} {
      @each $themeOptionName, $themeOptionValue in $themeOptions {
        @if bolt-list-contains($uniquePerTheme, $themeOptionName) == false {
          @include bolt-theme-value($themeOptionName, $themeOptionValue);
        }
      }

      // manually spec out the tertiary background + text colors vs using the original Theming
      // system to auto-generate a ton of extra vars we don't need;
      //
      // Part of the broader initiative to move Bolt to CSS vars + simplify our CSS Architecture
      //
      // @todo: review this when working through the new CSS custom property / vars spec (ex. http://vjira2:8080/browse/BDS-2031)
      @if ($themeName == 'xlight'){
        --bolt-theme--tertiary--background-color--default: #{rgba(bolt-color(gray), 0.15)};
        --bolt-theme--tertiary--background-color--hover: #{rgba(bolt-color(gray), 0.3)};
        --bolt-theme--tertiary--background-color--focus: #{rgba(bolt-color(gray), 0.4)};
        --bolt-theme--tertiary--background-color--active: #{rgba(bolt-color(gray), 0.5)};

        --bolt-theme--tertiary--text-color--default: #{rgba(bolt-color(black), 0.9)};
        --bolt-theme--tertiary--text-color--hover: #{rgba(bolt-color(black), 1)};
        --bolt-theme--tertiary--text-color--active: var(--bolt-theme--tertiary--text-color--hover);
        --bolt-theme--tertiary--text-color--focus: var(--bolt-theme--tertiary--text-color--hover);
      } @else {
        --bolt-theme--tertiary--background-color--default: #{rgba(bolt-color(white), 0.2)};
        --bolt-theme--tertiary--background-color--hover: #{rgba(bolt-color(white), 0.3)};
        --bolt-theme--tertiary--background-color--focus: #{rgba(bolt-color(white), 0.35)};
        --bolt-theme--tertiary--background-color--active: #{rgba(bolt-color(white), 0.4)};

        --bolt-theme--tertiary--text-color--default: #{rgba(bolt-color(white), 0.9)};
        --bolt-theme--tertiary--text-color--hover: #{rgba(bolt-color(white), 1)};
        --bolt-theme--tertiary--text-color--active: var(--bolt-theme--tertiary--text-color--hover);
        --bolt-theme--tertiary--text-color--focus: var(--bolt-theme--tertiary--text-color--hover);
      }
    }
  }

  #{unquote($themeSpecificSelector)} {
    @each $themeOptionName, $themeOptionValue in $themeOptions {
      @if $themeOptionName == 'background-secondary' {
        @include bolt-theme-value($themeOptionName, $themeOptionValue);
      } @elseif $themeOptionName == 'background' {
        @include bolt-theme-value($themeOptionName, $themeOptionValue);
        background-color: rgba(var(--bolt-theme-background), 1);
      } @elseif $themeOptionName == 'text' {
        @include bolt-theme-value($themeOptionName, $themeOptionValue);
        color: rgba(var(--bolt-theme-text), 1);
      }
    }
  }
}

.t-bolt-xxdark {
  --bolt-theme-background: 0, 0, 0;
}
