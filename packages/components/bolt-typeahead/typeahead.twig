{# @todo: re-enable once CSS Modules ships %}
{# {% set selectors = get_data("@bolt-components-typeahead/typeahead.scoped.json") %}
{% set classNames = {
  icon: selectors["c-bolt-typeahead__icon"],
  clearIcon: selectors["c-bolt-typeahead__icon--clear"],
  clearButton: [
    selectors["c-bolt-typeahead__button"],
    selectors["c-bolt-typeahead__button--clear"],
  ],
  submitButton: [
    selectors["c-bolt-typeahead__button"],
    selectors["c-bolt-typeahead__button--submit"],
  ],
  input: selectors["c-bolt-typeahead__input"],
  inputWrapper: selectors["c-bolt-typeahead__input-wrapper"],
  label: selectors["c-bolt-typeahead__label"],
  typeahead: selectors["c-bolt-typeahead"],
} %} #}

{% set classNames = {
  icon: "c-bolt-typeahead__icon",
  clearIcon: "c-bolt-typeahead__icon--clear",
  clearButton: [
    "c-bolt-typeahead__button",
    "c-bolt-typeahead__button--clear",
  ],
  submitButton: [
    "c-bolt-typeahead__button",
    "c-bolt-typeahead__button--submit",
  ],
  input: "c-bolt-typeahead__input",
  inputWrapper: "c-bolt-typeahead__input-wrapper",
  label: "c-bolt-typeahead__label",
  typeahead: "c-bolt-typeahead",
} %}

{% set utils = {
  visuallyHidden: "u-bolt-visuallyhidden",
  hidden: "u-bolt-hidden"
} %}

{% set text = {
  label: "Search the website",
  submit: "Search the website",
  clearInput: "Clear search input",
  inputPlaceholder: "Enter to search"
} %}

{% set data = {
  uuid: "bolt-typeahead-uuid"
} %}

{% set attributes = create_attribute(attributes|default({})) %}

{% set fallback_form_method = fallback_form_method | default('get') %}
{% set fallback_form_action = fallback_form_action | default('') %}
{% set fallback_form_target = fallback_form_target | default('_blank') %}

{% set search_icon %}
  {% embed "@bolt-components-icon/icon.twig" with {
    name: "search",
    preload: true,
    attributes: {
      class: [
        classNames.icon
      ]
    }
  } only %}
    {% block icon_inner %}
      {{ source("@bolt-components-typeahead/search.min.svg") }}
    {% endblock icon_inner %}
  {% endembed %}
{% endset %}


{% set clear_icon %}
  {% embed "@bolt-components-icon/icon.twig" with {
    name: "close-solid",
    preload: true,
    attributes: {
      class: [
        classNames.icon
      ]
    }
  } only %}
    {% block icon_inner %}
      {{ source("@bolt-components-typeahead/close-solid.min.svg") }}
    {% endblock icon_inner %}
  {% endembed %}
{% endset %}


{% spaceless %}
<bolt-typeahead {{ attributes }} placeholder="{{ text.inputPlaceholder }}">
  <div class="{{ classNames.typeahead }}">
    <form class="{{ classNames.inputWrapper }}" method="{{ fallback_form_method }}" action="{{ fallback_form_action }}" target="{{ fallback_form_target }}">
      <label for="{{ data.uuid }}" class="{{ classNames.label }}">
        <span class="{{ utils.visuallyHidden }}">{{ text.label }}</span>
      </label>
      <input
        id="{{ data.uuid }}"
        type="text"
        autocomplete="off"
        aria-autocomplete="list"
        class="{{ classNames.input }}"
        placeholder="{{ text.inputPlaceholder }}"
        value="{{ initialValue }}"
        required
        name="q"
      />

      {% embed "@bolt-components-button/button.twig" with {
        text: text.clearInput,
        iconOnly: true,
        color: "text",
        attributes: {
          onclick: "this.previousElementSibling.focus()",
          class: [
            classNames.clearButton | join(' ')
          ],
        },
        type: "reset"
      } %}
        {% block slot_after %}
          <replace-with-children class="c-bolt-button__icon">
            {{ clear_icon }}
          </replace-with-children>
        {% endblock slot_after %}
      {% endembed %}

      <div class="{{ classNames.submitButton | join(' ') }}">
        {% embed "@bolt-components-button/button.twig" with {
          text: text.submit,
          iconOnly: true,
          color: "text",
          type: "submit"
        } %}
          {% block slot_after %}
            <replace-with-children class="c-bolt-button__icon">
              {{ search_icon }}
            </replace-with-children>
          {% endblock slot_after %}
        {% endembed %}
      </div>
    </form>
  </div>
</bolt-typeahead>
{% endspaceless %}