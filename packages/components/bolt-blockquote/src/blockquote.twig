{% set schema = bolt.data.components["@bolt-components-blockquote"].schema %}

{% if enable_json_schema_validation %}
  {{ validate_data_schema(schema, _self) | raw }}
{% endif %}

{# set up psuedo self-validation by limiting param values to what's specifically allowed in the component schema #}
{% set size_options = schema.properties.size.enum %}

{% set align_items_options = {
  "left": "start",
  "center": "center",
  "right": "end"
} %}

{% set border_options = {
  "none": "borderless",
  "vertical": "bordered-vertical",
  "horizontal": "bordered-horizontal"
} %}

{% set attributes = create_attribute(attributes|default({})) %}

{% set base_class = "c-bolt-blockquote" %}

{# Prefix modified variables with 'mod_' and preserve original values #}
{% set mod_size = size == false and size is null ? "xlarge" : size | default("xlarge") %}
{% set mod_align_items = alignItems == false and alignItems is null ? "left" : alignItems | default("left") %}
{% set mod_border = border == false and border is null ? "vertical" : border | default("vertical") %}

{% set classes = [
  base_class,
  mod_size in size_options ? base_class ~ "--" ~ mod_size : "",
  mod_align_items in align_items_options|keys ? base_class ~ "--align-items-" ~ align_items_options[mod_align_items],
  mod_border in border_options|keys ? base_class ~ "--" ~ border_options[mod_border],
  indent ? base_class ~ "--indented" : "",
  fullBleed ? base_class ~ "--full" : ""
] %}

<bolt-blockquote
  {% if size %} size="{{ size }}" {% endif %}
  {% if alignItems %} align-items="{{ alignItems }}" {% endif %}
  {% if border %} border="{{ border }}" {% endif %}
  {% if indent %} indent {% endif %}
  {% if fullBleed %} full-bleed {% endif %}
>
  <blockquote {{ attributes.addClass(classes) }}>
    {% if logo %}
      {% block blockquote_logo %}
        <div class="{{ "#{base_class}__logo" }}">
          {% include "@bolt/logo.twig" with logo|merge({"lazyload": false}) only %}
        </div>
      {% endblock %}
    {% endif %}
    {% block blockquote_quote %}
      <div class="{{ "#{base_class}__quote" }}">
        {% include "@bolt-components-headline/text.twig" with {
          text: content,
          tag: "div",
          size: mod_size,
          weight: "semibold"
        } only %}
      </div>
    {% endblock %}
    {% if author %}
      {% block blockquote_footer %}
        <footer class="{{ "#{base_class}__footer" }}">
          {% if author.image %}
            <div class="{{ "#{base_class}__footer-item" }}">
              <div class="{{ "#{base_class}__image" }}">
                {% include "@bolt/image.twig" with author.image|merge({"lazyload": false}) only %}
              </div>
            </div>
          {% endif %}
          <div class="{{ "#{base_class}__footer-item" }}">
            {% include "@bolt-components-headline/text.twig" with {
              text: author.name,
              tag: "cite",
              size: "xsmall",
              weight: "bold"
            } only %}
            {% if author.title %}
              {% include "@bolt-components-headline/text.twig" with {
                text: author.title,
                size: "xsmall"
              } only %}
            {% endif %}
          </div>
        </footer>
      {% endblock %}
    {% endif %}
  </blockquote>
</bolt-blockquote>
