{% set schema = bolt.data.components['@bolt-components-copy-to-clipboard'].schema %}
{% if enable_json_schema_validation %}
  {{ validate_data_schema(schema, _self) | raw }}
{% endif %}

{% set prefix = "c-bolt-" %}
{% set componentName = "copy-to-clipboard" %} {# @todo: refactor to custom web component ASAP #}
{% set baseClass = prefix ~ componentName %}

{% set attributes = create_attribute(attributes|default({})) %}

{% set trigger_text = trigger_text | default("Copy Link"|t) %}
{% set copiedText = copiedText | default("Copied!"|t) %}
{% set iconSize = iconSize | default(schema.properties.iconSize.default) %}

{# DEPRECATED.  "url" has been renamed "text_to_copy" #}
{% if url %}
  {% set text_to_copy = url %}
{% endif %}

{# DEPRECATED.  "text" has been renamed "trigger_text" #}
{% if text %}
  {% set trigger_text = text %}
{% endif %}

{% set default_trigger %}
  <div class="{{ "#{baseClass}__action" }}">
    {% include "@bolt-components-icon/icon.twig" with {
      name: "asset-link",
      position: "before",
      size: iconSize
    } only %}
    <span class="{{ "#{baseClass}__action-text" }}">
      {{ trigger_text }}
    </span>
  </div>
{% endset %}

{% set default_transition %}
  <span class="{{ "#{baseClass}__transition-animation" }}">
    {% include "@bolt-components-icon/icon.twig" with {
      "name": "refresh",
      "size": iconSize,
    } only %}
  </span>
{% endset %}

{% set default_confirmation %}
  <div class="{{ "#{baseClass}__info js-bolt-copy-to-clipboard__trigger" }}">
    {% include "@bolt-components-icon/icon.twig" with {
      name: "check",
      position: "before",
      size: iconSize
    } only %}
    {{ copiedText }}
  </div>
{% endset %}


<bolt-copy-to-clipboard {{ attributes }}>
  <div class="{{ "#{baseClass}" }} js-bolt-copy-to-clipboard">
    <button class="{{ "#{baseClass}__trigger" }}" data-clipboard-text="{{ text_to_copy }}">
      {{ custom_trigger|default(default_trigger) }}
    </button>

    <span class="{{ "#{baseClass}__transition" }}">
      {{ custom_transition|default(default_transition) }}
    </span>

    <span class="{{ "#{baseClass}__confirmation" }}">
      {{ custom_confirmation|default(default_confirmation) }}
    </span>
  </div>
</bolt-copy-to-clipboard>
