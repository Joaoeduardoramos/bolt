{% set schema = bolt.data.components['@bolt-components-copy-to-clipboard'].schema %}
{% if enable_json_schema_validation %}
  {{ validate_data_schema(schema, _self) | raw }}
{% endif %}

{% set prefix = "c-bolt-" %}
{% set componentName = "copy-to-clipboard" %} {# @todo: refactor to custom web component ASAP #}
{% set baseClass = prefix ~ componentName %}

{% set attributes = create_attribute(attributes|default({})) %}

{% set text = text | default("Copy Link"|t) %}
{% set copiedText = copiedText | default("Copied!"|t) %}
{% set iconSize = iconSize | default(schema.properties.iconSize.default) %}



{% if not trigger %}
  {% set trigger %}
    {% include "@bolt-components-link/link.twig" with {
      "text": text,
      "url": "#!",
      "icon": {
        "name": "asset-link",
        "position": "before",
        "size": iconSize
      }
    } only %}
  {% endset %}
{% endif %}

{% if not spinner %}
  {% set spinner %}
    {% include "@bolt-components-icon/icon.twig" with {
      "name": "refresh",
      "size": iconSize,
    } only %}
  {% endset %}
{% endif %}

{% if not confirmation %}
  {% set confirmation %}
    {% include "@bolt-components-link/link.twig" with {
      "text": copiedText,
      "url": "#!",
      "icon": {
        "name": "check",
        "position": "before",
        "size": iconSize
      },
      "attributes": {
        "class": [
          "u-bolt-color-teal-dark",
          "js-bolt-copy-to-clipboard__trigger"
        ]
      }
    } only %}
  {% endset %}
{% endif %}


<bolt-copy-to-clipboard {{ attributes }}>
  <div class="{{ "#{baseClass}" }} js-bolt-copy-to-clipboard">
    <span class="{{ "#{baseClass}__trigger" }}" data-clipboard-text="{{ url }}">
      {{ trigger }}
    </span>

    <span class="{{ "#{baseClass}__spinner" }}">
      {{ spinner }}
    </span>

    <span class="{{ "#{baseClass}__confirmation" }}">
      {{ confirmation }}
    </span>
  </div>
</bolt-copy-to-clipboard>
